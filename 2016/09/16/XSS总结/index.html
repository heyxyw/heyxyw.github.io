<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>XSS 小结 | Zhouqiao&#39;s Blog | 人丑就要多读书</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="theme-color" content="#3F51B5">
  
  
  <meta name="keywords" content="web安全,XSS">
  <meta name="description" content="前言上一篇文章中写了关于项目中处理SQL盲注的安全漏洞.其中也提到了XSS.这篇文章就来说一下XSS 是怎么来进行攻击的,如何对其进行防御.
概述XSS攻击：跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS。
XSS是一种经常出现在web应用中的计算机安全漏洞，它允许恶意we">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS 小结">
<meta property="og:url" content="https://heyxyw.github.io/2016/09/16/XSS总结/index.html">
<meta property="og:site_name" content="Zhouqiao's Blog">
<meta property="og:description" content="前言上一篇文章中写了关于项目中处理SQL盲注的安全漏洞.其中也提到了XSS.这篇文章就来说一下XSS 是怎么来进行攻击的,如何对其进行防御.
概述XSS攻击：跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS。
XSS是一种经常出现在web应用中的计算机安全漏洞，它允许恶意we">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-1.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-2.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-3.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-4.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-5.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-6.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-7.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-8.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-9.jpg">
<meta property="og:image" content="http://odl62d8rn.bkt.clouddn.com/xss-10.jpg">
<meta property="og:updated_time" content="2016-09-17T06:57:50.213Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XSS 小结">
<meta name="twitter:description" content="前言上一篇文章中写了关于项目中处理SQL盲注的安全漏洞.其中也提到了XSS.这篇文章就来说一下XSS 是怎么来进行攻击的,如何对其进行防御.
概述XSS攻击：跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS。
XSS是一种经常出现在web应用中的计算机安全漏洞，它允许恶意we">
<meta name="twitter:image" content="http://odl62d8rn.bkt.clouddn.com/xss-1.jpg">
  
    <link rel="alternative" href="/atom.xml" title="Zhouqiao&#39;s Blog" type="application/atom+xml">
  
  <meta name="summary" content="人丑就要多读书">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="loading" class="active"></div>

  <nav id="menu" class="hide" >
   <div class="inner flex-row-vertical">
  <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
      <i class="icon icon-lg icon-close"></i>
  </a>
  <div class="brand-wrap">
    <div class="brand">
      <a href="/" class="avatar"><img src="/img/logo.jpg"></a>
      <hgroup class="introduce">
        <h5 class="nickname">Zhou qiao</h5>
        <a href="mailto:hellozhouqiao@gmail.com" title="hellozhouqiao@gmail.com" class="mail">hellozhouqiao@gmail.com</a>
      </hgroup>
    </div>
  </div>
  <div class="scroll-wrap flex-col">
    <ul class="nav">
      
          <li class="waves-block waves-effect">
            <a href="/"  >
              <i class="icon icon-lg icon-home"></i>
              主页
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/archives"  >
              <i class="icon icon-lg icon-archives"></i>
              Archives
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/tags"  >
              <i class="icon icon-lg icon-tags"></i>
              Tags
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="https://github.com/heyxyw" target="_blank" >
              <i class="icon icon-lg icon-github"></i>
              Github
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="http://www.weibo.com/18283587129miao" target="_blank" >
              <i class="icon icon-lg icon-weibo"></i>
              Weibo
            </a>
          </li>
      
          <li class="waves-block waves-effect">
            <a href="/404"  >
              <i class="icon icon-lg icon-link"></i>
              测试
            </a>
          </li>
      
    </ul>

    <footer class="footer">
  <p><a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0;vertical-align:middle;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAAllBMVEUAAAD///+rsapERER3d3eIiIjMzMzu7u4iIiKUmZO6v7rKzsoODg4RERFVVVUNDQ0NDg0PEA8zMzNLTEtbXltmZmZydnF9gn2AgICPkI+ZmZmqqqq7u7vFxsXIzMgNDQwZGRkgICAhISEkJSMnKCcuMC4xMzE5Ozk7PTtBQkFCQkJDQ0Nna2eGhoaHh4ezuLLGysbd3d1wVGpAAAAA4UlEQVR42q2T1xqCMAyFk7QsBQeKA9x7j/d/OSm22CpX0nzcpA1/T05aAOuBVkMAScQFHLnEwoCo2f1TnQIGoVMewjZEjVFN4GH1Ue1Cn2jWqwfsOOj6wDwGvotsl/c8lv7KIq1eLOsT0HMFHMIE/RZyHnlphryT9zyV+8WH5e8yQw3wnQvgAFxPTKUVi555SHR/lOfLMgVTeDlSfN+TaoUsiTyeIm+bCkHvCA2FUKG48LDtYBZBknsYP/G8NTw0gaaHyuQf4H5pecrB/FYCT2sL9zAfy1Xyjou6L8X2W7YcLyBZCRtnq/zfAAAAAElFTkSuQmCC" /></a></p>
  <p>Zhouqiao&#39;s Blog &copy; 2016</p>
  <p>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme
  <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></p>
  <a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-2x icon-rss-square"></i></a>
</footer>

  </div>
</div>

  </nav>
  <main id="main">
    <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">XSS 小结</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input " autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-share">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header">
  <div class="container">
    <h1 class="author">XSS 小结</h1>
    <h5 class="subtitle">
        
            <time datetime="2016-09-16T06:00:26.000Z" itemprop="datePublished" class="page-time">
  2016-09-16
</time>


        
    </h5>
  </div>
</header>

    <div class="container body-wrap">
      <article id="post-XSS总结" 
  class="article article-type-post" itemprop="blogPost">
    <div class="post-meta flex-row">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XSS/">XSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web安全/">web安全</a></li></ul>

    </div>
    <div class="post-body">
        <aside class="post-widget" id="post-widget">

            
            <div class="post-share" id="post-share">
    <div class="tit">分享到：</div>
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" href="javascript:;" data-title="微博" data-service="tsina">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns" href="javascript:;" data-title="微信" data-service="weixin">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" href="javascript:;" data-title=" QQ" data-service="cqq">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" href="javascript:;" data-title=" Facebook" data-service="fb">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" href="javascript:;" data-title=" Twitter" data-service="twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="douban share-sns" href="javascript:;" data-title="豆瓣" data-service="douban">
          豆
        </a>
      </li>
    </ul>
 </div>

            

            
            <nav class="post-toc-wrap" id="post-toc">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前言"><span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#概述"><span class="post-toc-text">概述</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#原理"><span class="post-toc-text">原理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#模拟XSS攻击实例-1"><span class="post-toc-text">模拟XSS攻击实例 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#模拟XSS攻击实例-2"><span class="post-toc-text">模拟XSS攻击实例 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决方案"><span class="post-toc-text">解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#方案-1"><span class="post-toc-text">方案 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#方案-2"><span class="post-toc-text">方案 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#结束语"><span class="post-toc-text">结束语</span></a></li></ol>
            </nav>
            
        </aside>

        <div class="post-main">

            <div class="post-content" id="post-content" itemprop="postContent">
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>上一篇文章中写了关于项目中处理<code>SQL盲注</code>的安全漏洞.其中也提到了<code>XSS</code>.这篇文章就来说一下XSS 是怎么来进行攻击的,如何对其进行防御.</p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p><code>XSS攻击</code>：跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为<code>XSS</code>。</p>
<p><code>XSS</code>是一种经常出现在web应用中的计算机安全漏洞，它允许恶意web用户将代码植入到提供给其它用户使用的页面中。比如这些代码包括HTML代码和客户端脚本。攻击者利用<code>XSS</code>漏洞旁路掉访问控制——例如同源策略(same origin policy)。这种类型的漏洞由于被黑客用来编写危害性更大的网络钓鱼(Phishing)攻击而变得广为人知。对于跨站脚本攻击，黑客界共识是：跨站脚本攻击是新型的“缓冲区溢出攻击“，而JavaScript是新型的“ShellCode”。</p>
<pre><code>`XSS`攻击的危害包括:
1、盗取各类用户帐号，如机器登录帐号、用户网银帐号、各类管理员帐号
2、控制企业数据，包括读取、篡改、添加、删除企业敏感数据的能力
3、盗窃企业重要的具有商业价值的资料
4、非法转账
5、强制发送电子邮件
6、网站挂马
7、控制受害者机器向其它网站发起攻击
</code></pre><p>—-摘自百度百科 <a href="http://baike.baidu.com/link?url=291kpLfadWCQiE2-4IBOKDTANH1VdI7RksMQsaKOZKt4bsGo6H2tfxioRxyH9V8BmzAtNQNPHGF_5xB2jFj2Nq" target="_blank" rel="external">XSS攻击</a></p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>我们首先搭建一个简易的环境来模拟<code>XSS</code> 攻击 ,其中<code>xssTest.jsp</code> 代码如下</p>
<h4 id="模拟XSS攻击实例-1"><a href="#模拟XSS攻击实例-1" class="headerlink" title="模拟XSS攻击实例 1"></a>模拟XSS攻击实例 1</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=utf-8"</span></span></div><div class="line">    <span class="attr">pageEncoding</span>=<span class="string">"utf-8"</span>%&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"xssTestServltet"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"txt"</span> <span class="attr">name</span>=<span class="string">"userName"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></div><div class="line">    您输入的账户为: $&#123;userName &#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>后台处理 <code>xssTestServlter.java</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@WebServlet</span>(<span class="string">"/xssTestServltet"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XssTestServltet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        <span class="comment">//接受参数</span></div><div class="line">        String userName=request.getParameter(<span class="string">"userName"</span>);</div><div class="line">        <span class="comment">//存储数据到 作用域</span></div><div class="line">        request.setAttribute(<span class="string">"userName"</span>, userName!=<span class="keyword">null</span>?userName:<span class="string">""</span>);</div><div class="line">        <span class="comment">//跳转到原页面.</span></div><div class="line">        request.getRequestDispatcher(<span class="string">"/xssTest.jsp"</span>).forward(request, response);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后我们请求到测试页面</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-1.jpg" alt="图片"></p>
<p>我们尝试输入 qazxc110,得到的结果为:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-2.jpg" alt="这里写图片描述"></p>
<p>此时页面源代码为:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-3.jpg" alt="这里写图片描述"></p>
<p>我们注意到,我们的输入的字符被原封不动的显示在 15行的位置.那么我们试想一下,如果我们在输入框中输入 这样一段代码:<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>,会是什么样子.按照刚才的测试,那么这次源码中在刚才的位置就应该显示<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code> 这串代码相当于在展示的位置插入了一段javaScript 代码,那么就应该执行alert弹出弹窗 并打印 <code>xss</code>.</p>
<p>我们按照刚才的假设,在代码中实验.我们输入<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code> 这串代码在文本框中,然后提交页面.然后我得到了一下页面:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-4.jpg" alt="这里写图片描述"></p>
<p>这时我们看到浏览器出现了弹窗,说明刚才的那段<code>script</code> 代码执行了.这个时候也就基本说明了,页面存在<code>XSS</code> 漏洞了.<br>此时的页面源码为:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-5.jpg" alt="这里写图片描述"></p>
<p>这是一种非常简单的方式.我们只是在页面上弹窗一个字符串而已,显然是执行了  <code>&lt;script&gt;&lt;/script&gt;</code>中的代码.那么这里面不但可以写弹窗代码,还可以写其他比如让页面跳转到一个指定的地址.如果这个地址的页面是一个跟当前页面相似的钓鱼页面的话,后果不堪设想.</p>
<p>很多网站都有留言模块.我们可以在留言板上插入一段恶意的代码,提交到后台.由于这段代码是保存在服务器上,若管理员并没有去及时发现并删除这段留言的代码,当范文留言列表的时候,留言会被加载出来.当用户访问这个留言的页面时,这段恶意代码就会执行.实例如下:</p>
<h4 id="模拟XSS攻击实例-2"><a href="#模拟XSS攻击实例-2" class="headerlink" title="模拟XSS攻击实例 2"></a>模拟XSS攻击实例 2</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 原页面访问地址.</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="meta">@WebServlet</span>(<span class="string">"/xssTestServltet"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XssTestServltet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        <span class="comment">//接受参数</span></div><div class="line">        String userName=request.getParameter(<span class="string">"userName"</span>);</div><div class="line">        <span class="comment">//存储数据到 作用域</span></div><div class="line">        request.setAttribute(<span class="string">"userName"</span>, userName!=<span class="keyword">null</span>?userName:<span class="string">""</span>);</div><div class="line"></div><div class="line">        <span class="comment">//模拟存储一个cookie 到 客户端.在xss 攻击链接中获取.</span></div><div class="line">        Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"xxzx"</span>,<span class="string">"1234"</span>);</div><div class="line">        response.addCookie(cookie);</div><div class="line"></div><div class="line">        <span class="comment">//模拟数据库中存储的留言.</span></div><div class="line">        request.setAttribute(<span class="string">"ly1"</span>, <span class="string">"xxzx"</span>);</div><div class="line">        <span class="comment">//模拟数据库中存储的留言.这里插入了一段 script 代码.去访问src 对应的xss 攻击 链接.</span></div><div class="line">        request.setAttribute(<span class="string">"ly2"</span>, <span class="string">"&lt;script src='http://localhost:8080/XssTestServlet2'&gt;&lt;/script&gt;么么哒"</span>);</div><div class="line">        <span class="comment">//跳转到原页面.</span></div><div class="line">        request.getRequestDispatcher(<span class="string">"/xssTest.jsp"</span>).forward(request, response);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 模拟留言中 xss 攻击的 地址.</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="meta">@WebServlet</span>(<span class="string">"/XssTestServlet2"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XssTestServlet2</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">        System.out.println(<span class="string">"访问了攻击地址......."</span>);</div><div class="line"></div><div class="line">        <span class="comment">//得到cookies</span></div><div class="line">        Cookie[] cookies = request.getCookies();</div><div class="line">        <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</div><div class="line">            System.out.println(<span class="string">"name:"</span>+cookie.getName());</div><div class="line">            System.out.println(<span class="string">"value:"</span>+cookie.getValue());</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这时我们任意用户在浏览器中访问 留言页面时,页面的代码:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-6.jpg" alt="这里写图片描述"></p>
<p>在<code>留言2</code> 的后面,还去加载了一个 我们之前定义好的<code>XSS</code> 链接 .这样一来我们除了请求正常的地址,页面还另外请求了攻击的地址:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-7.jpg" alt="这里写图片描述"></p>
<p>而在我们XSS 攻击地址的后台.我们获取到了这些信息:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-8.jpg" alt="这里写图片描述"></p>
<p>当管理员进入后台来浏览留言时,就会触发,然后管理员的cookie 后后台地址 等等一系列信息都可以被拿到,然后攻击者就可以用一些cookie欺诈工具来更改管理员的cookie ,就可以不用输入账号,密码 也可以以管理员的身份登录进系统.</p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>为解决上面出现的问题,现提供两种解决方案.</p>
<h4 id="方案-1"><a href="#方案-1" class="headerlink" title="方案 1"></a>方案 1</h4><p>我们使用一个第三方的jar 包.调用第三方的api 来防止 XSS 攻击带来的危险.具体步骤如下:</p>
<p>首先,添加 apache 的commons-lang-2.6.jar .</p>
<p>然后,在后台调用 <code>StringEscapeUtils.escapeHtml(string);</code> <code>StringEscapeUtils.escapeJavaScript(string);</code> <code>StringEscapeUtils.escapeSql(string);</code> 对请求过来的参数进行转义,若还需要这些值到前台.我们可以使用；<code>StringEscapeUtils.unescapeXXX(String)</code>;(<code>XXX</code> 可以表示 <code>Html</code>,<code>JavaScript</code>,<code>Sql</code>,<code>Xml</code> 等) 来进行反转义,或者在前台使用js 调用escape 可是可以的.</p>
<p>后台处理action:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/stringEscapeUtils"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stringEscapeUtils</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span></span>&#123;</div><div class="line">    String  str=request.getParameter(<span class="string">"username"</span>);</div><div class="line">    System.out.println(<span class="string">"username:   "</span>+str);</div><div class="line">    System.out.println(<span class="string">"escapeSql:   "</span>+StringEscapeUtils.escapeSql(str));</div><div class="line">    System.out.println(<span class="string">"escapeHtml:   "</span>+StringEscapeUtils.escapeHtml(str));</div><div class="line">    System.out.println(<span class="string">"escapeJavaScript:   "</span>+StringEscapeUtils.escapeJavaScript(str));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当我们前台输入:<code>&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;</code> 时,后台的输出结果为:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-9.jpg" alt="这里写图片描述"></p>
<p>注意:<code>commons-lang-3.x</code> 里面已经没有 <code>escapeSql</code> <code>escapeJavaScript</code> 方法,取而代之的是 <code>escapeEcmaScript</code> .具体的使用方法,就请自行验证了.</p>
<h4 id="方案-2"><a href="#方案-2" class="headerlink" title="方案 2"></a>方案 2</h4><p>这里我们重点说一下方案二.这也是我们解决<code>XSS</code> 攻击时采用的一种方式.</p>
<p>前面我们说到 <code>XSS</code> 攻击无非就是我们对于参数的过滤没有做好.导致一些不安全的字符被原封不动的进入到我们的业务中.那么最终就是对参数进行过滤.在这种方案中.我们需要自己写一个<code>Filter</code>,使用<code>Filter</code> 来过滤发出的请求.对于每个post 的请求的参数过滤一些关键字,把他们替换成安全的.例如：<code>&lt; &gt; &#39; &quot; \ / # &amp;</code> ,方法是实现一个自定义的 <code>HttpServletRequestWrapper</code> ,然后在<code>Filter</code> 里面调用它替换<code>getParameter</code> 方法即可,具体步骤如下.</p>
<p>首先 我们在后台添加一个 <code>XssHttpServletRequestWrapper</code> 类,让它继承 <code>javax.servlet.http.HttpServletRequestWrapper</code> ,代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.zhouq.filter.Xss;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequestWrapper;</div><div class="line"><span class="comment">/** 对请求 的参数 进行 Xss 安全过滤 </span></div><div class="line"> * <span class="doctag">@author</span> zhouq</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XssHttpServletRequestWrapper</span> <span class="keyword">extends</span> <span class="title">HttpServletRequestWrapper</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XssHttpServletRequestWrapper</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(request);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 替换 getParameterValues </div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> String[] getParameterValues(String parameter) &#123;</div><div class="line">        String[] values = <span class="keyword">super</span>.getParameterValues(parameter);</div><div class="line">        <span class="keyword">if</span> (values == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> count = values.length;</div><div class="line">        String[] eccodedValues = <span class="keyword">new</span> String[count];</div><div class="line"></div><div class="line">        <span class="comment">// 对每个参数值进行 XSS 清理</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</div><div class="line">            </div><div class="line">            eccodedValues[i] = cleanXSS(values[i]);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> eccodedValues;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 替换 getParameter </div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getParameter</span><span class="params">(String parameter)</span></span>&#123;</div><div class="line">        String value=<span class="keyword">super</span>.getParameter(parameter);</div><div class="line">        <span class="keyword">if</span>(value!=<span class="keyword">null</span>)&#123;</div><div class="line">            <span class="comment">//对参数值进行 XSS 清理</span></div><div class="line">            value=cleanXSS(value);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> value;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getHeader</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        String value = <span class="keyword">super</span>.getHeader(name);</div><div class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">return</span> cleanXSS(value);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/** XSS 清理</span></div><div class="line">     * <span class="doctag">@param</span> value</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">cleanXSS</span><span class="params">(String value)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"清理前  :"</span>+value);</div><div class="line">        value = value.replaceAll(<span class="string">"&lt;"</span>, <span class="string">"&amp; lt;"</span>).replaceAll(<span class="string">"&gt;"</span>, <span class="string">"&amp; gt;"</span>);</div><div class="line">        value = value.replaceAll(<span class="string">"\\("</span>, <span class="string">"&amp; #40;"</span>).replaceAll(<span class="string">"\\)"</span>, <span class="string">"&amp; #41;"</span>);</div><div class="line">        value = value.replaceAll(<span class="string">"'"</span>, <span class="string">"&amp; #39;"</span>);</div><div class="line">        value = value.replaceAll(<span class="string">"eval\\((.*)\\)"</span>, <span class="string">""</span>);</div><div class="line">        value = value.replaceAll(<span class="string">"[\\\"\\\'][\\s]*javascript:(.*)[\\\"\\\']"</span>, <span class="string">"\"\""</span>);</div><div class="line">        value = value.replaceAll(<span class="string">"script"</span>, <span class="string">""</span>);</div><div class="line">        System.out.println(<span class="string">"清理后  :"</span>+value);</div><div class="line">        System.out.println(<span class="string">"----------------------------------------------------------"</span>);</div><div class="line">        <span class="keyword">return</span> value;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后我们还需要在后台添加一个过滤器 <code>XssFilter</code> ,让它实现 <code>javax.servlet.Filter</code>,具体代码如下:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.zhouq.filter.Xss;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> javax.servlet.Filter;</div><div class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</div><div class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</div><div class="line"><span class="keyword">import</span> javax.servlet.ServletException;</div><div class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</div><div class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</div><div class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XssFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</div><div class="line"></div><div class="line">    FilterConfig config = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.config = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span></div><div class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</div><div class="line">        <span class="comment">//执行 我们自己定义的 XssHttpServletRequestWrapper</span></div><div class="line">        chain.doFilter(<span class="keyword">new</span> XssHttpServletRequestWrapper((HttpServletRequest) request), response);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</div><div class="line">        <span class="keyword">this</span>.config = config;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最后,我们还需要在web.xml 中应用 这个过滤器.web.xml 中的配置如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置自实现的 XSS 过滤器 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>XssFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.zhouq.filter.Xss.XssFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>XssFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure>
<p>到这里.我们的 <code>XSS</code> 清理就编写完成了.每一次请求中的危险字符,敏感信息都会被过滤掉,您可以去测试一下是否对您的应用生效.当然了,如果您要处理更多的字符,那么您可以继续在 <code>cleanXSS</code> 中去添加你需要处理的东西.当然,需要注意的是,一些必要的字符不能被过滤,否则就改变了用户的真实数据.比如在我们当前系统中在为菜单添加操作的时候 会有前缀为<code>javascript</code> 的代码.那么这里就会被过滤掉.如果你应用中也出现这种情况,那么就得请您自己做取舍了.</p>
<p>假设登录页面有个输入用户名和密码的输入框，可以有很多 <code>XSS</code>  <code>CSRF 注入钓鱼网站</code>  <code>SQL</code>注入等的攻击手段，例如：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">输入用户名 : &gt;"'&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">alert(1779)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </div><div class="line">输入用户名: usera&gt;"'&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"javascript:alert(23664)"</span>&gt;</span>  </div><div class="line">输入用户名: "'&gt;<span class="tag">&lt;<span class="name">IMG</span> <span class="attr">SRC</span>=<span class="string">"/WF_XSRF.html--end_hig--begin_highlight_tag--hlight_tag--"</span>&gt;</span>  </div><div class="line">输入用户名: usera'"&gt;<span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"http://demo.testfire.net--en--begin_highlight_tag--d_highlight_tag--"</span>&gt;</span>  </div><div class="line">  </div><div class="line">密码随意输入。</div></pre></td></tr></table></figure></p>
<p>下面提供了一个登录页面的攻击实例，你可以通过下面的方式进行简单的测试:</p>
<pre><code>用户名: `1&apos; or &apos;1&apos;=&apos;1` 

密码:`&lt;script&gt;alert(&apos;xss&apos;)&lt;/script&gt;` 
</code></pre><p>测试结果:</p>
<p><img src="http://odl62d8rn.bkt.clouddn.com/xss-10.jpg" alt="这里写图片描述"></p>
<h3 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h3><p>到这里，<code>XSS</code> 攻击的防御措施就写完了，使用 <code>Filter</code> 的这种方式，不仅仅可以防御 <code>XSS</code> 攻击，还可以防御 <code>CSRF</code> 攻击，<code>SQL注入</code> 等安全问题。</p>


            
            <div class="post-reward">
                <a id="rewardBtn" href="javascript:;" class="post-reward-btn waves-effect waves-circle waves-light">赏</a>
            </div>
            
            
            <blockquote>
                <p>
                本文地址：
                <a href="https://heyxyw.github.io/2016/09/16/XSS总结/" target="_blank" rel="external">https://heyxyw.github.io/2016/09/16/XSS总结/</a>
                </p>
                <footer><cite><a href="https://heyxyw.github.io">@Zhouqiao's Blog</a></cite></footer>
            </blockquote>
            </div>
            
<nav class="post-nav">
  

  
    <div class="waves-block waves-effect next fr">
      <a href="/2016/09/15/SQL盲注/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">SQL盲注</h4>
      </a>
    </div>
  
</nav>


            
            
<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="XSS总结" data-title="XSS 小结" data-url="https://heyxyw.github.io/2016/09/16/XSS总结/index.html"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"ysblog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>





        </div>
    </div>
</article>
    </div>
  </main>
<div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>

<script>
var BLOG_SHARE = {
    title: "XSS 小结",
    pic: "/img/logo.jpg",
    summary: document.getElementsByName('summary')[0].content,
    url: "https://heyxyw.github.io/2016/09/16/XSS总结/index.html"
};
</script>
<div class="global-share" id="global-share">
    <div class="tit">分享到：</div>
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" href="javascript:;" data-title="微博" data-service="tsina">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns" href="javascript:;" data-title="微信" data-service="weixin">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" href="javascript:;" data-title=" QQ" data-service="cqq">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" href="javascript:;" data-title=" Facebook" data-service="fb">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" href="javascript:;" data-title=" Twitter" data-service="twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="douban share-sns" href="javascript:;" data-title="豆瓣" data-service="douban">
          豆
        </a>
      </li>
    </ul>
 </div>




<div id="reward" class="reward-lay">
    <a class="reward-off" id="rewardOff" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        
        <li>
            <img src="/img/wechat.jpg" title="微信打赏二维码" alt="微信打赏二维码">
            <p>微信</p>
        </li>
        

        
        <li>
            <img src="/img/alipay.jpg" title="支付宝打赏二维码" alt="支付宝打赏二维码">
            <p>支付宝</p>
        </li>
        
    </ul>
</div>

<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script src="/js/main.js"></script>



<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<script type="text/template" id="search-tpl">
<li class="item">
    <a href="/{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</script>

<script src="/js/search.js"></script>









</body>
</html>
